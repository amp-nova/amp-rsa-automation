{ 
	"$schema": "http://json-schema.org/draft-07/schema#",
	"$id": "https://amprsa.net/component/rule-based-content",

	"title": "Rule Based Content",
	"description": "",

	"allOf": [
		{
			"$ref": "http://bigcontent.io/cms/schema/v1/core#/definitions/content"
		}
	],
	
	"type": "object",
	"properties": {
		"active": {
			"type": "boolean",
			"title": "Active"
		},
		"priority": {
			"type": "number",
			"title": "Priority"
		},
        "rules": {
			"title": "Rules",
			"type": "object",
			"properties": {
				"productCategories": {
					"title": "Product Categories",
					"type": "object",
					"properties": {
						"values": {
							"type": "array",
							"ui:extension": {
								"name": "hierarchy-picker",
								"params": {
									"nodeId": "{{cms.hierarchies.pages}}",
									"type": "chip"
								}
							},
							"items": {
								"allOf": [{
										"$ref": "http://bigcontent.io/cms/schema/v1/core#/definitions/content-reference"
									},
									{
										"properties": {
											"contentType": {
												"enum": [
													"https://amprsa.net/page/category"
												]
											}
										}
									}
								]
							}
						}
					}
				},
				"tags": {
					"title": "Tags",
					"type": "object",
					"properties": {
						"values": {
							"type": "array",
							"ui:extension": {
								"name": "hierarchy-picker",
								"params": {
									"nodeId": "{{cms.hierarchies.taxonomies}}",
									"type": "chip"
								}
							},
							"items": {
								"allOf": [{
										"$ref": "http://bigcontent.io/cms/schema/v1/core#/definitions/content-link"
									},
									{
										"properties": {
											"contentType": {
												"enum": [
													"https://amprsa.net/taxonomy/tag"
												]
											}
										}
									}
								]
							}
						}
					}
				},
				"pageTypes": {
					"title": "Page Types",
					"type": "object",
					"properties": {
						"values": {
							"type": "array",
							"ui:extension": {
								"name": "hierarchy-picker",
								"params": {
									"nodeId": "{{cms.hierarchies.taxonomies}}",
									"type": "chip"
								}
							},
							"items": {
								"allOf": [{
										"$ref": "http://bigcontent.io/cms/schema/v1/core#/definitions/content-link"
									},
									{
										"properties": {
											"contentType": {
												"enum": [
													"https://amprsa.net/taxonomy/page-type"
												]
											}
										}
									}
								]
							}
						}
					}
				}
			}
		},
		"content": {
			"title": "Component",
			"allOf": [
				{ "$ref": "http://bigcontent.io/cms/schema/v1/core#/definitions/content-link" },
				{
					"properties": {
						"contentType": { "$ref": "https://amprsa.net/lib/components#/definitions/anyComponent" }
					}
				}
			]
		}
    },
    
    "definitions": {
    }
}